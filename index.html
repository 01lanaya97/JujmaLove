<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I Love You Jujma</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    

    <style>
        :root {
            --pink-shadow: rgba(255, 81, 168, 0.712);
            --pink-main: #ff85a1;
        }

        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #fcfefc;
            font-family: 'Playfair Display', sans-serif;
            overflow: hidden;
        }

        /* –ï–∫—Ä–∞–Ω–∏ */
        #mainScreen, #puzzleScreen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 1s ease-in-out;
        }

        #puzzleScreen {
            opacity: 0;
            pointer-events: none;
            background: #fff5f7;
            flex-direction: column;
        }

        .container {
            position: relative;
            width: 450px;
            height: 600px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .character {
            position: absolute;
            bottom: 270px;
            left: 45px;
            width: 150px;
            z-index: 5;
        }

        #heartContainer {
            margin-left: 90px;
            margin-top: -100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 280px;
            z-index: 10;
        }

        .heart-row { display: flex; }
        
        .heart-glow {
            filter: drop-shadow(0 0 15px rgba(255, 182, 193, 0.808))
            drop-shadow(0 0 30px rgba(255, 105, 180, 0.288));
            transition: filter 1.5s ease-in-out;
        }

        .mini-heart {
            font-size: 18px;
            margin: 1px;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .mini-heart.show { opacity: 1; transform: scale(1); }
        .bounce-animation { animation: bounce 1.2s ease-in-out infinite alternate; }

        .text-container {
            margin-top: 50px;
            font-size: 42px;
            font-family: 'Playfair Display', serif;
            font-weight: bold;
            color: #d63384;
            text-shadow: 0 0 15px var(--pink-shadow);
            opacity: 0;
            visibility: hidden;
        }

        .text-container.visible { 
            opacity: 1; 
            visibility: visible;
            transition: opacity 1s; 
        }

        .letter { display: inline-block; animation: flash 2s infinite; }

        /* –ö–Ω–æ–ø–∫–∞ —Å—é—Ä–ø—Ä–∏–∑—É */
        #surpriseBtn {
            margin-top: 40px;
            padding: 12px 25px;
            border: none;
            background: #ff85a1;
            color: white;
            border-radius: 25px;
            font-family: 'Comfortaa', sans-serif;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px var(--pink-shadow);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        #surpriseBtn.show { opacity: 1; transform: translateY(0); }
        #surpriseBtn:hover { background: #d63384; transform: scale(1.1); }

        /* –ü'—è—Ç–Ω–∞—à–∫–∞ */
        .puzzle-title { font-family: 'Playfair Display', serif; color: #d63384; font-size: 30px; margin-bottom: 20px; }
        
        .puzzle-grid {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 5px;
            background: white;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(214, 51, 132, 0.2);
        }

        .puzzle-item {
            width: 100px;
            height: 100px;
            background-size: 300px 300px; /* –î–ª—è —Ñ–æ—Ç–æ 3—Ö3 */
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .puzzle-item.empty {
            background: #fff0f3 !important;
            cursor: default;
        }

        /* –§—ñ–Ω–∞–ª */
        #winMessage {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.5); /* –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω –¥–ª—è –∞–Ω—ñ–º–∞—Ü—ñ—ó */
    width: 320px;
    padding: 30px;
    background: white;
    border-radius: 30px;
    box-shadow: 0 20px 60px rgba(214, 51, 132, 0.3);
    display: none; /* –•–æ–≤–∞—î–º–æ —Å–ø–æ—á–∞—Ç–∫—É */
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    text-align: center;
    border: 3px solid #fff0f3;
    transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

#winMessage.show-modal {
    display: flex;
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
}

/* –ó–∞—Ç–µ–º–Ω–µ–Ω–Ω—è —Ñ–æ–Ω—É */
#overlay {
    position: fixed;
    inset: 0;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(5px);
    display: none;
    z-index: 9999;
}
        .dancing-card { width: 150px; animation: dance 2s infinite ease-in-out; margin-top: 20px; }

        @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-20px); } }
        @keyframes flash { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; filter: brightness(1.5); } }
        @keyframes dance {
            0%, 100% { transform: rotate(-8deg) scale(1); }
            50% { transform: rotate(8deg) scale(1.1); }
        }

/* –ö–æ–Ω–≤–µ—Ä—Ç-–∫–Ω–æ–ø–∫–∞ (–∑–∞–º—ñ—Å—Ç—å –≥—ñ—Ñ–∫–∏ —É –º–æ–¥–∞–ª—å–Ω–æ–º—É –≤—ñ–∫–Ω—ñ) */
.envelope-btn {
    width: 120px;
    cursor: pointer;
    transition: transform 0.3s ease;
    animation: dance 2s infinite ease-in-out;
}

/* –ê–Ω—ñ–º–æ–≤–∞–Ω–∞ —Å—Ç—Ä—ñ–ª–æ—á–∫–∞ */
.arrow-pointer {
    position: absolute;
    right: -40px; /* –ó–±–æ–∫—É –≤—ñ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞ */
    top: 50%;
    font-size: 30px;
    color: var(--pink-dark);
    opacity: 0;
    transition: opacity 0.5s ease;
    animation: point 1s infinite alternate ease-in-out;
}

@keyframes point {
    from { transform: translateX(0); }
    to { transform: translateX(-15px); }
}

#letterOverlay {
    position: fixed;
    inset: 0;
    background: rgba(255, 240, 245, 0.6); /* –ù—ñ–∂–Ω–æ-—Ä–æ–∂–µ–≤–∏–π –ø—Ä–æ–∑–æ—Ä–∏–π —Ñ–æ–Ω */
    backdrop-filter: blur(10px);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 30000;
}

/* –ö–∞—Ä—Ç–∫–∞-–ª–∏—Å—Ç —É —Å—Ç–∏–ª—ñ "Coquette" */
.letter-card {
    position: relative;
    width: 85%;
    max-width: 400px;
    background: #ffffff;
    padding: 50px 40px;
    border-radius: 60px 5px 60px 5px; /* –ï–ª–µ–≥–∞–Ω—Ç–Ω—ñ –∑–∞–∫—Ä—É–≥–ª–µ–Ω—ñ –∫—É—Ç–∏ */
    box-shadow: 0 15px 45px rgba(255, 182, 193, 0.4);
    border: 2px solid #fff0f5;
    background-image: 
        radial-gradient(#fff5f7 1px, transparent 1px); /* –õ–µ–¥—å –ø–æ–º—ñ—Ç–Ω–∞ —Ç–µ–∫—Å—Ç—É—Ä–∞ */
    background-size: 20px 20px;
}

/* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–µ —Å–µ—Ä–¥–µ—á–∫–æ –∑–≤–µ—Ä—Ö—É –ª–∏—Å—Ç–∞ */
.letter-card::before {
    content: 'üå∏';
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 30px;
    filter: drop-shadow(0 2px 5px rgba(0,0,0,0.1));
}

#typingText {
    font-family: 'Playfair Display', serif;
    font-size: 20px;
    line-height: 1.7;
    color: #5d4a4e; /* –ú'—è–∫–∏–π –∫–æ—Ä–∏—á–Ω–µ–≤–æ-—Ä–æ–∂–µ–≤–∏–π –∫–æ–ª—ñ—Ä –∑–∞–º—ñ—Å—Ç—å —á–æ—Ä–Ω–æ–≥–æ */
    font-style: italic;
    text-align: center;
}

/* –ù—ñ–∂–Ω–∏–π –∫—É—Ä—Å–æ—Ä */
.cursor {
    display: inline-block;
    width: 8px;
    height: 8px;
    background-color: #ffb6c1;
    border-radius: 50%; /* –ö—É—Ä—Å–æ—Ä-–∫—Ä–∞–ø–æ—á–∫–∞ –∑–∞–º—ñ—Å—Ç—å —Ä–∏—Å–∫–∏ */
    margin-left: 5px;
    animation: blink 0.8s infinite;
}

/* –ö–Ω–æ–ø–∫–∞-—Å–µ—Ä–¥–µ—á–∫–æ –≤ –∫—ñ–Ω—Ü—ñ */
.final-img {
    width: 70px;
    cursor: pointer;
    filter: drop-shadow(0 5px 15px rgba(255, 105, 180, 0.4));
    transition: all 0.4s ease;
}

#finalNextBtn {
    margin-top: 30px;
    display: none; /* –ü–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–∏–±–∏—Ä–∞—î–º–æ –∑ –ø–æ—Ç–æ–∫—É */
    opacity: 0;
    visibility: hidden; /* –î–æ–¥–∞—Ç–∫–æ–≤–∏–π –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–µ—Ä–µ–¥—á–∞—Å–Ω–æ—ó –ø–æ—è–≤–∏ */
    text-align: center;
}

.final-img:hover {
    transform: scale(1.2) rotate(10deg);
}




/* –û—Å—Ç–∞–Ω–Ω—ñ–π –µ–∫—Ä–∞–Ω */
#finalPage {
    position: fixed;
    inset: 0;
    background: #fff5f7; /* –î—É–∂–µ –Ω—ñ–∂–Ω–∏–π —Ä–æ–∂–µ–≤–∏–π */
    z-index: 50000;
    display: none;
    opacity: 0;
    transition: opacity 1.5s ease-in-out;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

/* –°—Ç–∏–ª—å –¥–ª—è –∫—É–ø–∫—É —Ñ–æ—Ç–æ */
.photo-stack {
    position: relative;
    width: 300px;
    height: 400px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.stacked-photo {
    position: absolute;
    width: 220px;
    height: 280px;
    object-fit: cover;
    border: 8px solid white;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    border-radius: 2px;
    opacity: 0;
    transform: scale(0.5) rotate(0deg);
    transition: all 1.2s cubic-bezier(0.23, 1, 0.32, 1);
}

/* –ú–æ–¥–∞–ª—å–Ω–∞ –∫–∞—Ä—Ç–∫–∞ "–¢–∏—Ü—å–Ω–∏" */
#flipCardContainer {
    position: absolute;
    width: 180px;
    height: 100px;
    perspective: 1000px;
    display: none;
    opacity: 0;
    z-index: 60000;
    cursor: pointer;
}

.flip-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
}

.flip-card-inner.flipped {
    transform: rotateY(180deg);
}

.flip-front, .flip-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    border-radius: 15px;
    background: white;
    box-shadow: 0 10px 30px rgba(255, 182, 193, 0.5);
    border: 2px solid #fff0f5;
}

.flip-back {
    transform: rotateY(180deg);
    background: #fff0f5;
}

.date-text {
    position: absolute;
    bottom: 10px;
    right: 15px;
    font-size: 10px;
    color: #d63384;
    font-family: 'Comfortaa', sans-serif;
}
    </style>
</head>
<body>
<div id="overlay"></div>
<div id="mainScreen">
    <div class="container">
        <img src="biu.gif" alt="Biu Biu" class="character" id="mainGif">
        <div id="heartContainer"></div>
        <div class="text-container" id="textContainer">
            <span class="letter" style="animation-delay: 0.1s">I</span>
            <span class="letter">&nbsp;</span>
            <span class="letter" style="animation-delay: 0.3s">L</span>
            <span class="letter" style="animation-delay: 0.4s">O</span>
            <span class="letter" style="animation-delay: 0.5s">V</span>
            <span class="letter" style="animation-delay: 0.6s">E</span>
            <span class="letter">&nbsp;</span>
            <span class="letter" style="animation-delay: 0.8s">Y</span>
            <span class="letter" style="animation-delay: 0.9s">O</span>
            <span class="letter" style="animation-delay: 1.0s">U</span>
        </div>
        <button id="surpriseBtn">–¢–∏—Å–Ω–∏ —Å—é—Ä–ø—Ä–∏–∑ ‚ú®</button>
    </div>

    
    
    <div id="flipCardContainer">
        <div class="flip-card-inner" id="cardInner">
            <div class="flip-front">
                <span style="font-family: 'Comfortaa'; color: #ff85a1;">–¢–∏—Ü—å–Ω–∏ ‚ú®</span>
            </div>
            <div class="flip-back">
                <span style="font-family: 'Playfair Display'; color: #d63384; font-weight: bold; font-size: 18px;">
                    –ó –î–Ω–µ–º –°–≤—è—Ç–æ–≥–æ –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ ‚ù§Ô∏è
                </span>
                <span class="date-text">14.02.2026</span>
            </div>
        </div>
    </div>
</div>
</div>

<div id="puzzleScreen">
    <h2 class="puzzle-title">–ó–±–µ—Ä–∏ –ø–∞–∑–ª –∫–æ—Ö–∞–Ω–Ω—è ‚ù§Ô∏è</h2>
    <div class="puzzle-grid" id="puzzleGrid"></div>
    
    <div id="winMessage">
    <h1 style="color: #d63384; font-family: 'Playfair Display'; margin-bottom: 20px;">–¢–æ–±—ñ –ª–∏—Å—Ç! üå∏</h1>
    
    <div style="position: relative;">
        <!--  –§–û–¢–û –ö–û–ù–í–ï–†–¢–ê -->
        <img src="letter.png" class="envelope-btn" id="openLetterBtn" alt="–ö–æ–Ω–≤–µ—Ä—Ç">
        <div class="arrow-pointer" id="hintArrow">üí´</div>
    </div>
    
    <p style="font-family: 'Comfortaa'; color: #ff85a1; margin-top: 15px;">–ù–∞—Ç–∏—Å–Ω–∏, —â–æ–± –ø—Ä–æ—á–∏—Ç–∞—Ç–∏</p>
</div>
<div id="letterOverlay">
    <div class="letter-card">
        <div id="typingText"></div><span id="cursor" class="cursor"></span>
        
        <!-- –ö–∞—Ä—Ç–∏–Ω–∫–∞-–∫–Ω–æ–ø–∫–∞ –≤ –∫—ñ–Ω—Ü—ñ -->
        <div id="finalNextBtn">
            <img src="miha.png" class="final-img" alt="–î–∞–ª—ñ" id="toLastPage">
            <p style="font-size: 12px; color: #aaa; font-family: 'Comfortaa';">–¢–æ—Ä–∫–Ω–∏—Å—å, —â–æ–± –π—Ç–∏ –¥–∞–ª—ñ</p>
        </div>
    </div>
</div>
</div>

<script>
    const PHOTO_PATH = 'jujmi.jpg'; 
    const heartContainer = document.getElementById('heartContainer');
    const textContainer = document.getElementById('textContainer');
    const surpriseBtn = document.getElementById('surpriseBtn');
    const GIF_DURATION = 9500; 
    const MY_LETTER_TEXT = `–ü—Ä–∏–≤–µ—Ç, —Å–æ–ª–Ω—ã—à–∫–æ! 
–Ø —Ö–æ—á—É —Å–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –∫–æ–µ-—á—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ–µ... 
–¢—ã - –ª—É—á—à–µ–µ, —á—Ç–æ —Å–ª—É—á–∞–ª–æ—Å—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏. 
–ö–∞–∂–¥–∞—è –º–∏–Ω—É—Ç–∞ —Å —Ç–æ–±–æ–π - —ç—Ç–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ —Å—á–∞—Å—Ç—å–µ. 
–°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ –∑–∞ —Ç–≤–æ—é —É–ª—ã–±–∫—É –∏ —Å–º–µ—Ö, –∑–∞ —Ç–≤–æ—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –∑–∞ —Ç–æ, —á—Ç–æ —Ç—ã –ø—Ä–æ—Å—Ç–æ –µ—Å—Ç—å.
–Ø –æ–±–µ—â–∞—é –≤—Å–µ–≥–¥–∞ –±—ã—Ç—å —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π –≤ —Ö–æ—Ä–æ—à–µ–º –∏ –ø–ª–æ—Ö–æ–º. 
–Ø –æ–±–µ—â–∞—é –≤—Å–µ–≥–¥–∞ —Å–ª—É—à–∞—Ç—å —Ç–µ–±—è, –æ —Ç–æ–º –∫–∞–∫ –ø—Ä–æ—à–ª–∏ —Ç–≤–æ–∏ –¥–Ω–∏.
–¢—ã –º–æ–π —Å–∞–º—ã–π –ª—É—á—à–∏–π!
–ù–∞ —Ç–µ–±—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–ª–∏—Ç—å—Å—è. 
–î–∞–∂–µ –∫–æ–≥–¥–∞ –º—ã –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –º–Ω–æ–≥–∏—Ö –º–∏–ª—å –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞, –º—ã –≤–º–µ—Å—Ç–µ —Å–µ—Ä–¥—Ü–µ–º ‚ù§Ô∏è.
   –¢—ã –∑–Ω–∞—á–∏—à—å –¥–ª—è –º–µ–Ω—è –±–æ–ª—å—à–µ —á–µ–º –≤–µ—Å—å –º–∏—Ä.
–Ø –ª—é–±–ª—é —Ç–µ–±—è –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∏ –Ω–∞ —á—Ç–æ! `;

    // 1. –ú–∞–ª—é–≤–∞–Ω–Ω—è –≤–µ–ª–∏–∫–æ–≥–æ —Å–µ—Ä—Ü—è (Screen 1)
    const heartPattern = [
        [0,0,1,1,0,0,0,1,1,0,0], [0,1,1,1,1,0,1,1,1,1,0],
        [1,1,1,1,1,1,1,1,1,1,1], [1,1,1,1,1,1,1,1,1,1,1],
        [0,1,1,1,1,1,1,1,1,1,0], [0,0,1,1,1,1,1,1,1,0,0],
        [0,0,0,1,1,1,1,1,0,0,0], [0,0,0,0,1,1,1,0,0,0,0], [0,0,0,0,0,1,0,0,0,0,0]
    ];

    function drawHeart() {
        const allHearts = [];
        heartPattern.forEach((row) => {
            const rowDiv = document.createElement('div');
            rowDiv.className = 'heart-row';
            row.forEach((cell) => {
                const heart = document.createElement('span');
                heart.className = 'mini-heart';
                heart.innerHTML = '‚ù§Ô∏è';
                if (cell === 0) heart.style.visibility = 'hidden';
                else allHearts.push(heart);
                rowDiv.appendChild(heart);
            });
            heartContainer.appendChild(rowDiv);
        });

        allHearts.sort(() => Math.random() - 0.5);
        let maxD = 0;
        allHearts.forEach((h, i) => {
            const d = Math.floor(i / 5) * 400 + (Math.random() * 200);
            maxD = Math.max(maxD, d);
            setTimeout(() => h.classList.add('show'), d);
        });

        setTimeout(() => {
            heartContainer.classList.add('bounce-animation', 'heart-glow');
            textContainer.classList.add('visible');
            setTimeout(() => surpriseBtn.classList.add('show'), 3000);
        }, maxD + 500);
    }

    // 2. –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –ø–∞–∑–ª—É
    surpriseBtn.onclick = () => {
        document.getElementById('mainScreen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('mainScreen').style.display = 'none';
            const ps = document.getElementById('puzzleScreen');
            ps.style.opacity = '1';
            ps.style.pointerEvents = 'all';
            startPuzzle();
        }, 1000);
    };

    // 3. –õ–æ–≥—ñ–∫–∞ –ø–∞–∑–ª—É (3 –∫—Ä–æ–∫–∏ –ø–µ—Ä–µ–º—ñ—à—É–≤–∞–Ω–Ω—è)
    let tiles = [0, 1, 2, 3, 4, 5, 6, 7, null]; 
    
    function startPuzzle() {
        let currentEmpty = 8;
        let lastPos = -1;
        for (let i = 0; i < 3; i++) {
            const moves = getValidMoves(currentEmpty).filter(m => m !== lastPos);
            const move = moves[Math.floor(Math.random() * moves.length)];
            [tiles[currentEmpty], tiles[move]] = [tiles[move], tiles[currentEmpty]];
            lastPos = currentEmpty;
            currentEmpty = move;
        }
        renderPuzzle();
    }

    function getValidMoves(idx) {
        const m = [];
        if (idx % 3 > 0) m.push(idx - 1);
        if (idx % 3 < 2) m.push(idx + 1);
        if (idx > 2) m.push(idx - 3);
        if (idx < 6) m.push(idx + 3);
        return m;
    }

    function renderPuzzle() {
        const grid = document.getElementById('puzzleGrid');
        grid.innerHTML = '';
        tiles.forEach((tile, idx) => {
            const cell = document.createElement('div');
            cell.className = `puzzle-item ${tile === null ? 'empty' : ''}`;
            if (tile !== null) {
                cell.style.backgroundImage = `url('${PHOTO_PATH}')`;
                cell.style.backgroundPosition = `${(tile % 3) * 50}% ${Math.floor(tile / 3) * 50}%`;
                cell.style.backgroundSize = "300px 300px";
            }
            cell.onclick = () => {
                const emptyIdx = tiles.indexOf(null);
                if (getValidMoves(emptyIdx).includes(idx)) {
                    [tiles[idx], tiles[emptyIdx]] = [tiles[emptyIdx], tiles[idx]];
                    renderPuzzle();
                    checkWin();
                }
            };
            grid.appendChild(cell);
        });
    }

    // 4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–µ—Ä–µ–º–æ–≥–∏ —Ç–∞ –°–ê–ú–û–†–£–ë–ù–ò–ô –°–ê–õ–Æ–¢
    function checkWin() {
    const isWin = tiles.every((t, i) => t === (i === 8 ? null : i));
    if (isWin) {
        createMegaFireworks();
        
        setTimeout(() => {
            const wm = document.getElementById('winMessage');
            const overlay = document.getElementById('overlay');
            const arrow = document.getElementById('hintArrow');
            
            overlay.style.display = 'block';
            wm.style.display = 'flex';
            setTimeout(() => wm.classList.add('show-modal'), 10);

            // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥–∏ –∑'—è–≤–ª—è—î—Ç—å—Å—è —Å—Ç—Ä—ñ–ª–æ—á–∫–∞
            setTimeout(() => {
                arrow.style.opacity = '1';
            }, 3000);
        }, 2000);
    }
}

document.getElementById('openLetterBtn').onclick = function() {
    // –•–æ–≤–∞—î–º–æ –≤—ñ–∫–Ω–æ –∑ –∫–æ–Ω–≤–µ—Ä—Ç–æ–º
    document.getElementById('winMessage').style.display = 'none';
    document.getElementById('overlay').style.display = 'none';
    
    // –ü–æ–∫–∞–∑—É—î–º–æ –ª–∏—Å—Ç
    document.getElementById('letterOverlay').style.display = 'flex';
    startTyping(MY_LETTER_TEXT);
};

function startTyping(text) {
    const textContainer = document.getElementById('typingText');
    const cursor = document.getElementById('cursor');
    const finalBtn = document.getElementById('finalNextBtn');
    
    // –ü–ï–†–ï–ö–û–ù–ê–Ñ–ú–û–°–Ø, –©–û –ö–ù–û–ü–ö–ê –ü–†–ò–•–û–í–ê–ù–ê –ü–ï–†–ï–î –ü–û–ß–ê–¢–ö–û–ú
    finalBtn.style.display = 'none';
    finalBtn.style.opacity = '0';
    finalBtn.style.visibility = 'hidden';
    
    textContainer.innerHTML = '';
    let i = 0;
    
    function type() {
        if (i < text.length) {
            let char = text.charAt(i);
            textContainer.innerHTML += char;
            i++;
            
            // –ü–∞—É–∑–∏ –Ω–∞ —Ä–æ–∑–¥—ñ–ª–æ–≤–∏—Ö –∑–Ω–∞–∫–∞—Ö –¥–ª—è —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–æ—Å—Ç—ñ
            let speed = (char === '.' || char === '!' || char === ',') ? 400 : 60;
            setTimeout(type, speed + Math.random() * 40);
        } else {
            // –¢–ï–ö–°–¢ –ó–ê–í–ï–†–®–ï–ù–û
            
            // 1. –ü—Ä–∏–±–∏—Ä–∞—î–º–æ –∫—É—Ä—Å–æ—Ä
            cursor.style.transition = 'opacity 1s';
            cursor.style.opacity = '0';
            setTimeout(() => cursor.style.display = 'none', 1000);
            
            // 2. –ü–õ–ê–í–ù–ê –ü–û–Ø–í–ê –ö–ù–û–ü–ö–ò (–¢–Ü–õ–¨–ö–ò –ó–ê–†–ê–ó!)
            setTimeout(() => {
                finalBtn.style.display = 'block';
                finalBtn.style.visibility = 'visible';
                
                // –ê–Ω—ñ–º–∞—Ü—ñ—è –º'—è–∫–æ–≥–æ –≤–∏–ø–ª–∏–≤–∞–Ω–Ω—è
                finalBtn.animate([
                    { opacity: 0, transform: 'translateY(10px) scale(0.8)' },
                    { opacity: 1, transform: 'translateY(0) scale(1)' }
                ], { 
                    duration: 1200, 
                    fill: 'forwards', 
                    easing: 'ease-out' 
                });
            }, 1000); // –ö–Ω–æ–ø–∫–∞ –∑'—è–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ 1 —Å–µ–∫ –ø—ñ—Å–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –∫—Ä–∞–ø–∫–∏
        }
    }
    type();
}


    // –§–£–ù–ö–¶–Ü–Ø –°–ê–õ–Æ–¢–£
    function createMegaFireworks() {
    // –°—Ç–≤–æ—Ä—é—î–º–æ 150 —Å–µ—Ä–¥–µ—á–æ–∫ –∑–∞–º—ñ—Å—Ç—å 50
    for (let i = 0; i < 350; i++) {
        setTimeout(() => {
            const heart = document.createElement('div');
            // –í–∏–ø–∞–¥–∫–æ–≤–æ –≤–∏–±–∏—Ä–∞—î–º–æ –µ–º–æ–¥–∑—ñ –∞–±–æ —Å–∏–º–≤–æ–ª
            const hearts = ['‚ù§Ô∏è', 'üíñ', 'üíù', 'üíï', 'üå∏'];
            heart.innerHTML = hearts[Math.floor(Math.random() * hearts.length)];
            
            heart.style.position = 'fixed';
            // –ü–æ—á–∞—Ç–∫–æ–≤–∞ —Ç–æ—á–∫–∞ - —Ü–µ–Ω—Ç—Ä –µ–∫—Ä–∞–Ω—É
            heart.style.left = '50%';
            heart.style.top = '50%';
            heart.style.fontSize = (Math.random() * 25 + 15) + 'px';
            heart.style.zIndex = '11000';
            heart.style.pointerEvents = 'none';
            heart.style.transition = `all ${Math.random() * 2 + 1}s cubic-bezier(0.1, 0.5, 0.3, 1)`;
            
            document.body.appendChild(heart);

            // –í–∏–ø–∞–¥–∫–æ–≤–∏–π —Ä–æ–∑–ª—ñ—Ç –Ω–∞ –≤–µ—Å—å –µ–∫—Ä–∞–Ω
            const angle = Math.random() * Math.PI * 2;
            const dist = Math.random() * 800 + 200; // –í–µ–ª–∏–∫–∞ –¥–∏—Å—Ç–∞–Ω—Ü—ñ—è
            const x = Math.cos(angle) * dist;
            const y = Math.sin(angle) * dist;

            // –ê–Ω—ñ–º–∞—Ü—ñ—è —Ä–æ–∑–ª—å–æ—Ç—É —Ç–∞ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è
            requestAnimationFrame(() => {
                heart.style.transform = `translate(${x}px, ${y}px) rotate(${Math.random() * 360}deg) scale(0)`;
                heart.style.opacity = '0';
            });

            // –í–∏–¥–∞–ª—è—î–º–æ –µ–ª–µ–º–µ–Ω—Ç –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
            setTimeout(() => heart.remove(), 2000);
        }, i * 10); // –ü–æ—Ä—Ü—ñ–π–Ω–∞ –ø–æ—è–≤–∞ –¥–ª—è –µ—Ñ–µ–∫—Ç—É –≤–∏–±—É—Ö—É
    }
}
// –°–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö 9 –∑–æ–±—Ä–∞–∂–µ–Ω—å (–≤–∫–∞–∂—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –Ω–∞–∑–≤–∏ —Ñ–∞–π–ª—ñ–≤)
const FINAL_PHOTOS = [
    '1.jpg', '2.jpg', '3.jpg', 
    '4.jpg', '5.jpg', '6.jpg', 
    '7.jpg', '8.jpg', '9.jpg'
];

document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('toLastPage');
    btn.addEventListener('click', () => {

window.location.href = "final.html";

});

});

function showStackedPhotos() {
    const stack = document.getElementById('photoStack');
    
    FINAL_PHOTOS.forEach((src, index) => {
        setTimeout(() => {
            const img = document.createElement('img');
            img.src = src;
            img.className = 'stacked-photo';
            
            // –í–∏–ø–∞–¥–∫–æ–≤–∏–π –Ω–µ–≤–µ–ª–∏–∫–∏–π –Ω–∞—Ö–∏–ª –¥–ª—è –µ—Ñ–µ–∫—Ç—É "–∫—É–ø–∏"
            const randomRotation = Math.random() * 20 - 10;
            const randomX = Math.random() * 20 - 10;
            const randomY = Math.random() * 20 - 10;

            stack.appendChild(img);

            // –ê–Ω—ñ–º–∞—Ü—ñ—è –ø–æ—è–≤–∏
            requestAnimationFrame(() => {
                img.style.opacity = '1';
                img.style.transform = `translate(${randomX}px, ${randomY}px) rotate(${randomRotation}deg) scale(1)`;
            });

            // –Ø–∫—â–æ —Ü–µ –æ—Å—Ç–∞–Ω–Ω—î —Ñ–æ—Ç–æ ‚Äî –ø–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É "–¢–∏—Ü—å–Ω–∏"
            if (index === FINAL_PHOTOS.length - 1) {
                setTimeout(showFlipCard, 1500);
            }
        }, index * 800); // –ö–æ–∂–Ω–µ —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑ 0.8 —Å–µ–∫
    });
}

function showFlipCard() {
    const card = document.getElementById('flipCardContainer');
    card.style.display = 'block';
    setTimeout(() => {
        card.style.opacity = '1';
        card.style.transform = 'translateY(0) scale(1)';
    }, 100);
}

// –õ–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç—É –∫–∞—Ä—Ç–∫–∏
document.getElementById('flipCardContainer').onclick = function() {
    document.getElementById('cardInner').classList.toggle('flipped');
    
    // –î–æ–¥–∞–º–æ —â–µ —Ç—Ä–æ—Ö–∏ –∫–æ–Ω—Ñ–µ—Ç—Ç—ñ –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç—ñ, —è–∫—â–æ –∑–∞—Ö–æ—á–µ—à
    createMegaFireworks(); 
};
    window.onload = () => setTimeout(drawHeart, GIF_DURATION);
</script>

</body>
</html>